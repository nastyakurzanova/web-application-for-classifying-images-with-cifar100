# -*- coding: utf-8 -*-
"""cifar100_mobile.onnx

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1KX-Y4RhyzLTdRanWxkrLDRiyrgttuXAm
"""

import torch
#device = torch.device('cpu')
device = torch.device('cuda'  if torch.cuda.is_available()  else  'cpu')
model = torch.hub.load("chenyaofo/pytorch-cifar-models",
	"cifar100_mobilenetv2_x0_5",
	# 'cifar100_resnet20',
	pretrained=True)

!pip install onnx

model.to(device)

x = torch.randn(1,  3,  32,  32, requires_grad=True).to(device)

torch.onnx.export(model, x, "cifar100_CNN_RESNET20.onnx", export_params=True, opset_version=9, do_constant_folding=True, input_names = ['input'], output_names = ['output'],  dynamic_axes={'input'  :  {0  :  'batch_size'}, 'output'  :  {0  :  'batch_size'}})

